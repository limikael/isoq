{
  "version": 3,
  "sources": ["../src/index.jsx", "../../../src/isoq/IsoqClient.js", "../../../src/isoq/DefaultErrorFallback.js", "../../../src/isoq/client.jsx"],
  "sourcesContent": ["import {Link, Route, useLoaderData, useIsoContext, useIsLoading, useIsoRef} from \"isoq\";\nimport {useEffect, lazy, Suspense, useMemo} from \"react\";\n\nfunction Home() {\n\treturn (\n\t\t<p>This is the home page</p>\n\t);\n}\n\nfunction SomePage() {\n\tlet loaderData=useLoaderData();\n\n\tconsole.log(\"render some page\");\n\n\treturn (\n\t\t<p>This is another page, loaderData={loaderData}</p>\n\t);\n}\n\nSomePage.loader=async()=>{\n\tconsole.log(\"Loading some data for some page...\");\n\n\tawait new Promise(r=>setTimeout(r,1000));\n\n\t//throw new Error(\"Loader fail\");\n\n\treturn \"123\";\n}\n\nexport default function Main() {\n\tlet loading=useIsLoading();\n\tlet bg=loading?\"#0000ff\":\"#ffffff\";\n\n\treturn (<>\n\t\t<div style={`width: 100%; height: 3px; background-color: ${bg}`}/>\n\t\t<div>\n\t\t\t<Link href=\"/\">Home</Link>\n\t\t\t|\n\t\t\t<Link href=\"/somepage\">Some Page</Link>\n\t\t\t|\n\t\t\t<Link href=\"/lazypage\">Lazy Page</Link>\n\t\t</div>\n\n\t\t<Route path=\"/\">\n\t\t\t<Home/>\n\t\t</Route>\n\n\t\t<Route path=\"/somepage\" loader={SomePage.loader}>\n\t\t\t<SomePage/>\n\t\t</Route>\n\n\t\t<Route path=\"/lazypage\" lazy={()=>import(\"./LazyPage.jsx\")}/>\n\t</>);\n}", "import {parseCookie, stringifyCookie} from \"../utils/js-util.js\";\n\nexport default class IsoqClient {\n\tconstructor(refs) {\n\t\tthis.refs=refs;\n\t\tthis.req=new Request(window.location);\n\t\tthis.cookieDispatcher=new EventTarget();\n\t}\n\n\tgetIsoRef(id) {\n\t\treturn this.refs[id];\n\t}\n\n\tmarkIsoRefStale(id) {\n\t\tdelete this.refs[id];\n\t}\n\n\tisSsr() {\n\t\treturn false;\n\t}\n\n\tgetUrl() {\n\t\treturn window.location;\n\t}\n\n\tredirect(url) {\n\t\twindow.location=url;\n\t}\n\n\tfetch=async (url,options={})=>{\n\t\tif (url.startsWith(\"/\"))\n\t\t\turl=new URL(this.req.url).origin+url;\n\n\t\treturn await fetch(url,options);\n\t}\n\n\tgetBarrier(id) {\n\t\treturn ()=>{};\n\t}\n\n\tunresolveBarrier() {\n\t}\n\n\tgetCookie(key) {\n\t\tlet parsedCookie=parseCookie(window.document.cookie);\n\t\treturn parsedCookie[key];\n\t}\n\n\tsetCookie(key, value, options={}) {\n\t\tdocument.cookie=stringifyCookie(key,value,options);\n\t\tthis.cookieDispatcher.dispatchEvent(new Event(key));\n\t}\n}", "import {createElement} from \"react\";\n\nexport default function DefaultErrorFallback({error}) {\n\tlet style={\n\t\tposition: \"fixed\",\n\t\tleft: \"0\",\n\t\ttop: \"0\",\n\t\twidth: \"100%\",\n\t\theight: \"100%\",\n\t\tzOrder: \"100\",\n\t\tbackgroundColor: \"#000000\",\n\t\tcolor: \"#ff0000\",\n\t\tfontSize: \"16px\",\n\t\tfontFamily: \"monospace\",\n\t\tborderStyle: \"solid\",\n\t\tborderWidth: \"0.5em\",\n\t\tborderColor: \"#ff0000\",\n\t\tpadding: \"0.5em\",\n\t\tboxSizing: \"border-box\",\n\t\twhiteSpace: \"pre\"\n\t}\n\n\t//console.error(error);\n\n\tlet message=error.toString();\n\tif (error.stack)\n\t\tmessage=error.stack;\n\n\treturn createElement(\"div\",{style: style},message);\n}\n", "import Browser from \"@browser\";\nimport IsoqClient from \"./IsoqClient.js\";\nimport IsoContext from \"./IsoContext.js\";\nimport {RouterProvider} from \"../components/router.js\";\nimport {IsoIdNamespace, useIsoId, IsoIdRoot} from \"../components/useIsoId.js\";\nimport {IsoErrorBoundary} from \"../components/IsoErrorBoundary.js\";\nimport DefaultErrorFallback from \"./DefaultErrorFallback.js\";\n\nif (!window.__isoError) {\n\tlet isoClient=new IsoqClient(window.__isoRefs);\n\tlet content=(\n\t\t<IsoContext.Provider value={isoClient}>\n\t\t\t<IsoErrorBoundary fallback={DefaultErrorFallback}>\n\t\t\t\t<IsoIdRoot name=\"root\">\n\t\t\t\t\t<RouterProvider>\n\t\t\t\t\t\t<Browser {...window.__isoProps}/>\n\t\t\t\t\t</RouterProvider>\n\t\t\t\t</IsoIdRoot>\n\t\t\t</IsoErrorBoundary>\n\t\t</IsoContext.Provider>\n\t)\n\thydrate(content,document.getElementById(\"isoq\"));\n\tif (Object.keys(isoClient.refs).length)\n\t\tconsole.log(\n\t\t\t\"Warning, unused refs after hydration: \",\n\t\t\tObject.keys(isoClient.refs)\n\t\t);\n}\n"],
  "mappings": "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",
  "names": []
}
